/* Auto-generated lookup table generator from glibc's wcwidth results */

// ---------- Build widths array ----------
const MAX_CP = 0x10FFFF;
const widths = new Uint8Array(MAX_CP + 1);

// Start with everything as non-printable
widths.fill(0xFF);

const cp0 = [
  0x000000, 0x0005BF, 0x0005C7, 0x00061C, 0x000670, 0x000711, 0x0007FD,
  0x00093A, 0x00093C, 0x00094D, 0x000981, 0x0009BC, 0x0009CD, 0x0009FE,
  0x000A3C, 0x000A51, 0x000A75, 0x000ABC, 0x000ACD, 0x000B01, 0x000B3C,
  0x000B3F, 0x000B4D, 0x000B82, 0x000BC0, 0x000BCD, 0x000C00, 0x000C04,
  0x000C3C, 0x000C81, 0x000CBC, 0x000CBF, 0x000CC6, 0x000D4D, 0x000D81,
  0x000DCA, 0x000DD6, 0x000E31, 0x000EB1, 0x000F35, 0x000F37, 0x000F39,
  0x000FC6, 0x001082, 0x00108D, 0x00109D, 0x0017C6, 0x0017DD, 0x0018A9,
  0x001932, 0x001A1B, 0x001A56, 0x001A60, 0x001A62, 0x001A7F, 0x001B34,
  0x001B3C, 0x001B42, 0x001BE6, 0x001BED, 0x001CED, 0x001CF4, 0x002D7F,
  0x003164, 0x00A802, 0x00A806, 0x00A80B, 0x00A82C, 0x00A8FF, 0x00A9B3,
  0x00A9E5, 0x00AA43, 0x00AA4C, 0x00AA7C, 0x00AAB0, 0x00AAC1, 0x00AAF6,
  0x00ABE5, 0x00ABE8, 0x00ABED, 0x00FB1E, 0x00FEFF, 0x00FFA0, 0x0101FD,
  0x0102E0, 0x010A3F, 0x011001, 0x011070, 0x0110C2, 0x011173, 0x0111CF,
  0x011234, 0x01123E, 0x011241, 0x0112DF, 0x011340, 0x0113CE, 0x0113D0,
  0x0113D2, 0x011446, 0x01145E, 0x0114BA, 0x01163D, 0x0116AB, 0x0116AD,
  0x0116B7, 0x01171D, 0x01171F, 0x01193E, 0x011943, 0x0119E0, 0x011A47,
  0x011C3F, 0x011D3A, 0x011D47, 0x011D95, 0x011D97, 0x011F40, 0x011F42,
  0x011F5A, 0x013440, 0x016F4F, 0x016FE4, 0x01DA75, 0x01DA84, 0x01E08F,
  0x01E2AE, 0x0E0001
];

const cp1 = [
  0x00038C, 0x0005BE, 0x0005C0, 0x0005C3, 0x0005C6, 0x00061B, 0x0006E9,
  0x0007B1, 0x00081A, 0x000824, 0x000828, 0x00085E, 0x0008E2, 0x00093B,
  0x0009B2, 0x0009CE, 0x0009D7, 0x000A03, 0x000A5E, 0x000A76, 0x000A83,
  0x000AC9, 0x000AD0, 0x000AF9, 0x000B40, 0x000B57, 0x000B83, 0x000B9C,
  0x000BD0, 0x000BD7, 0x000C3D, 0x000C5D, 0x000DBD, 0x000E84, 0x000EA5,
  0x000EBD, 0x000EC6, 0x000F36, 0x000F38, 0x000F7F, 0x000F85, 0x001031,
  0x001038, 0x0010C7, 0x0010CD, 0x001258, 0x0012C0, 0x001715, 0x0017B6,
  0x0018AA, 0x001940, 0x001A57, 0x001A61, 0x001B35, 0x001B3B, 0x001BAA,
  0x001BE7, 0x001BEE, 0x001CD3, 0x001CE1, 0x001CFA, 0x001F59, 0x001F5B,
  0x001F5D, 0x0026F4, 0x00274D, 0x002756, 0x002D27, 0x002D2D, 0x00303F,
  0x00A673, 0x00A7D3, 0x00A95F, 0x00AA4D, 0x00AAB1, 0x00AAC0, 0x00AAC2,
  0x00FB1D, 0x00FB3E, 0x00FDCF, 0x0101A0, 0x010808, 0x01083C, 0x01093F,
  0x010EAD, 0x011000, 0x011075, 0x0110CD, 0x01112C, 0x011235, 0x011288,
  0x011350, 0x011357, 0x01138B, 0x01138E, 0x0113C2, 0x0113C5, 0x0113CF,
  0x0113D1, 0x011445, 0x01145D, 0x0114B9, 0x0114C1, 0x0115BE, 0x01163E,
  0x0116AC, 0x0116B6, 0x01171E, 0x011726, 0x011838, 0x01183B, 0x011909,
  0x01193D, 0x011A00, 0x011A50, 0x011A97, 0x011C3E, 0x011CA9, 0x011CB1,
  0x011CB4, 0x011D46, 0x011D96, 0x011D98, 0x011F41, 0x011FB0, 0x016AF5,
  0x01BC9C, 0x01BC9F, 0x01D245, 0x01D4A2, 0x01D4BB, 0x01D546, 0x01E2FF,
  0x01E5FF, 0x01E94B, 0x01EE24, 0x01EE27, 0x01EE39, 0x01EE3B, 0x01EE42,
  0x01EE47, 0x01EE49, 0x01EE4B, 0x01EE54, 0x01EE57, 0x01EE59, 0x01EE5B,
  0x01EE5D, 0x01EE5F, 0x01EE64, 0x01EE7E, 0x01F336, 0x01F37D, 0x01F43F,
  0x01F441, 0x01F54F, 0x01F93B, 0x01F946
];

const cp2 = [
  0x0023F0, 0x0023F3, 0x00267F, 0x002693, 0x0026A1, 0x0026CE, 0x0026D4,
  0x0026EA, 0x0026F5, 0x0026FA, 0x0026FD, 0x002705, 0x002728, 0x00274C,
  0x00274E, 0x002757, 0x0027B0, 0x0027BF, 0x002B50, 0x002B55, 0x01B132,
  0x01B155, 0x01F004, 0x01F0CF, 0x01F18E, 0x01F3F4, 0x01F440, 0x01F57A,
  0x01F5A4, 0x01F6CC, 0x01F7F0
];

const range0 = [
  [0x000300, 0x00036F], [0x000483, 0x000489], [0x000591, 0x0005BD],
  [0x0005C1, 0x0005C2], [0x0005C4, 0x0005C5], [0x000610, 0x00061A],
  [0x00064B, 0x00065F], [0x0006D6, 0x0006DC], [0x0006DF, 0x0006E4],
  [0x0006E7, 0x0006E8], [0x0006EA, 0x0006ED], [0x000730, 0x00074A],
  [0x0007A6, 0x0007B0], [0x0007EB, 0x0007F3], [0x000816, 0x000819],
  [0x00081B, 0x000823], [0x000825, 0x000827], [0x000829, 0x00082D],
  [0x000859, 0x00085B], [0x000897, 0x00089F], [0x0008CA, 0x0008E1],
  [0x0008E3, 0x000902], [0x000941, 0x000948], [0x000951, 0x000957],
  [0x000962, 0x000963], [0x0009C1, 0x0009C4], [0x0009E2, 0x0009E3],
  [0x000A01, 0x000A02], [0x000A41, 0x000A42], [0x000A47, 0x000A48],
  [0x000A4B, 0x000A4D], [0x000A70, 0x000A71], [0x000A81, 0x000A82],
  [0x000AC1, 0x000AC5], [0x000AC7, 0x000AC8], [0x000AE2, 0x000AE3],
  [0x000AFA, 0x000AFF], [0x000B41, 0x000B44], [0x000B55, 0x000B56],
  [0x000B62, 0x000B63], [0x000C3E, 0x000C40], [0x000C46, 0x000C48],
  [0x000C4A, 0x000C4D], [0x000C55, 0x000C56], [0x000C62, 0x000C63],
  [0x000CCC, 0x000CCD], [0x000CE2, 0x000CE3], [0x000D00, 0x000D01],
  [0x000D3B, 0x000D3C], [0x000D41, 0x000D44], [0x000D62, 0x000D63],
  [0x000DD2, 0x000DD4], [0x000E34, 0x000E3A], [0x000E47, 0x000E4E],
  [0x000EB4, 0x000EBC], [0x000EC8, 0x000ECE], [0x000F18, 0x000F19],
  [0x000F71, 0x000F7E], [0x000F80, 0x000F84], [0x000F86, 0x000F87],
  [0x000F8D, 0x000F97], [0x000F99, 0x000FBC], [0x00102D, 0x001030],
  [0x001032, 0x001037], [0x001039, 0x00103A], [0x00103D, 0x00103E],
  [0x001058, 0x001059], [0x00105E, 0x001060], [0x001071, 0x001074],
  [0x001085, 0x001086], [0x001160, 0x0011FF], [0x00135D, 0x00135F],
  [0x001712, 0x001714], [0x001732, 0x001733], [0x001752, 0x001753],
  [0x001772, 0x001773], [0x0017B4, 0x0017B5], [0x0017B7, 0x0017BD],
  [0x0017C9, 0x0017D3], [0x00180B, 0x00180F], [0x001885, 0x001886],
  [0x001920, 0x001922], [0x001927, 0x001928], [0x001939, 0x00193B],
  [0x001A17, 0x001A18], [0x001A58, 0x001A5E], [0x001A65, 0x001A6C],
  [0x001A73, 0x001A7C], [0x001AB0, 0x001ACE], [0x001B00, 0x001B03],
  [0x001B36, 0x001B3A], [0x001B6B, 0x001B73], [0x001B80, 0x001B81],
  [0x001BA2, 0x001BA5], [0x001BA8, 0x001BA9], [0x001BAB, 0x001BAD],
  [0x001BE8, 0x001BE9], [0x001BEF, 0x001BF1], [0x001C2C, 0x001C33],
  [0x001C36, 0x001C37], [0x001CD0, 0x001CD2], [0x001CD4, 0x001CE0],
  [0x001CE2, 0x001CE8], [0x001CF8, 0x001CF9], [0x001DC0, 0x001DFF],
  [0x00200B, 0x00200F], [0x00202A, 0x00202E], [0x002060, 0x002064],
  [0x002066, 0x00206F], [0x0020D0, 0x0020F0], [0x002CEF, 0x002CF1],
  [0x002DE0, 0x002DFF], [0x00302A, 0x00302D], [0x003099, 0x00309A],
  [0x00A66F, 0x00A672], [0x00A674, 0x00A67D], [0x00A69E, 0x00A69F],
  [0x00A6F0, 0x00A6F1], [0x00A825, 0x00A826], [0x00A8C4, 0x00A8C5],
  [0x00A8E0, 0x00A8F1], [0x00A926, 0x00A92D], [0x00A947, 0x00A951],
  [0x00A980, 0x00A982], [0x00A9B6, 0x00A9B9], [0x00A9BC, 0x00A9BD],
  [0x00AA29, 0x00AA2E], [0x00AA31, 0x00AA32], [0x00AA35, 0x00AA36],
  [0x00AAB2, 0x00AAB4], [0x00AAB7, 0x00AAB8], [0x00AABE, 0x00AABF],
  [0x00AAEC, 0x00AAED], [0x00D7B0, 0x00D7C6], [0x00D7CB, 0x00D7FB],
  [0x00FE00, 0x00FE0F], [0x00FE20, 0x00FE2F], [0x010376, 0x01037A],
  [0x010A01, 0x010A03], [0x010A05, 0x010A06], [0x010A0C, 0x010A0F],
  [0x010A38, 0x010A3A], [0x010AE5, 0x010AE6], [0x010D24, 0x010D27],
  [0x010D69, 0x010D6D], [0x010EAB, 0x010EAC], [0x010EFC, 0x010EFF],
  [0x010F46, 0x010F50], [0x010F82, 0x010F85], [0x011038, 0x011046],
  [0x011073, 0x011074], [0x01107F, 0x011081], [0x0110B3, 0x0110B6],
  [0x0110B9, 0x0110BA], [0x011100, 0x011102], [0x011127, 0x01112B],
  [0x01112D, 0x011134], [0x011180, 0x011181], [0x0111B6, 0x0111BE],
  [0x0111C9, 0x0111CC], [0x01122F, 0x011231], [0x011236, 0x011237],
  [0x0112E3, 0x0112EA], [0x011300, 0x011301], [0x01133B, 0x01133C],
  [0x011366, 0x01136C], [0x011370, 0x011374], [0x0113BB, 0x0113C0],
  [0x0113E1, 0x0113E2], [0x011438, 0x01143F], [0x011442, 0x011444],
  [0x0114B3, 0x0114B8], [0x0114BF, 0x0114C0], [0x0114C2, 0x0114C3],
  [0x0115B2, 0x0115B5], [0x0115BC, 0x0115BD], [0x0115BF, 0x0115C0],
  [0x0115DC, 0x0115DD], [0x011633, 0x01163A], [0x01163F, 0x011640],
  [0x0116B0, 0x0116B5], [0x011722, 0x011725], [0x011727, 0x01172B],
  [0x01182F, 0x011837], [0x011839, 0x01183A], [0x01193B, 0x01193C],
  [0x0119D4, 0x0119D7], [0x0119DA, 0x0119DB], [0x011A01, 0x011A0A],
  [0x011A33, 0x011A38], [0x011A3B, 0x011A3E], [0x011A51, 0x011A56],
  [0x011A59, 0x011A5B], [0x011A8A, 0x011A96], [0x011A98, 0x011A99],
  [0x011C30, 0x011C36], [0x011C38, 0x011C3D], [0x011C92, 0x011CA7],
  [0x011CAA, 0x011CB0], [0x011CB2, 0x011CB3], [0x011CB5, 0x011CB6],
  [0x011D31, 0x011D36], [0x011D3C, 0x011D3D], [0x011D3F, 0x011D45],
  [0x011D90, 0x011D91], [0x011EF3, 0x011EF4], [0x011F00, 0x011F01],
  [0x011F36, 0x011F3A], [0x013447, 0x013455], [0x01611E, 0x016129],
  [0x01612D, 0x01612F], [0x016AF0, 0x016AF4], [0x016B30, 0x016B36],
  [0x016F8F, 0x016F92], [0x01BC9D, 0x01BC9E], [0x01BCA0, 0x01BCA3],
  [0x01CF00, 0x01CF2D], [0x01CF30, 0x01CF46], [0x01D167, 0x01D169],
  [0x01D173, 0x01D182], [0x01D185, 0x01D18B], [0x01D1AA, 0x01D1AD],
  [0x01D242, 0x01D244], [0x01DA00, 0x01DA36], [0x01DA3B, 0x01DA6C],
  [0x01DA9B, 0x01DA9F], [0x01DAA1, 0x01DAAF], [0x01E000, 0x01E006],
  [0x01E008, 0x01E018], [0x01E01B, 0x01E021], [0x01E023, 0x01E024],
  [0x01E026, 0x01E02A], [0x01E130, 0x01E136], [0x01E2EC, 0x01E2EF],
  [0x01E4EC, 0x01E4EF], [0x01E5EE, 0x01E5EF], [0x01E8D0, 0x01E8D6],
  [0x01E944, 0x01E94A], [0x0E0020, 0x0E007F], [0x0E0100, 0x0E01EF]
];

const range1 = [
  [0x000020, 0x00007E], [0x0000A0, 0x0002FF], [0x000370, 0x000377],
  [0x00037A, 0x00037F], [0x000384, 0x00038A], [0x00038E, 0x0003A1],
  [0x0003A3, 0x000482], [0x00048A, 0x00052F], [0x000531, 0x000556],
  [0x000559, 0x00058A], [0x00058D, 0x00058F], [0x0005D0, 0x0005EA],
  [0x0005EF, 0x0005F4], [0x000600, 0x00060F], [0x00061D, 0x00064A],
  [0x000660, 0x00066F], [0x000671, 0x0006D5], [0x0006DD, 0x0006DE],
  [0x0006E5, 0x0006E6], [0x0006EE, 0x00070D], [0x00070F, 0x000710],
  [0x000712, 0x00072F], [0x00074D, 0x0007A5], [0x0007C0, 0x0007EA],
  [0x0007F4, 0x0007FA], [0x0007FE, 0x000815], [0x000830, 0x00083E],
  [0x000840, 0x000858], [0x000860, 0x00086A], [0x000870, 0x00088E],
  [0x000890, 0x000891], [0x0008A0, 0x0008C9], [0x000903, 0x000939],
  [0x00093D, 0x000940], [0x000949, 0x00094C], [0x00094E, 0x000950],
  [0x000958, 0x000961], [0x000964, 0x000980], [0x000982, 0x000983],
  [0x000985, 0x00098C], [0x00098F, 0x000990], [0x000993, 0x0009A8],
  [0x0009AA, 0x0009B0], [0x0009B6, 0x0009B9], [0x0009BD, 0x0009C0],
  [0x0009C7, 0x0009C8], [0x0009CB, 0x0009CC], [0x0009DC, 0x0009DD],
  [0x0009DF, 0x0009E1], [0x0009E6, 0x0009FD], [0x000A05, 0x000A0A],
  [0x000A0F, 0x000A10], [0x000A13, 0x000A28], [0x000A2A, 0x000A30],
  [0x000A32, 0x000A33], [0x000A35, 0x000A36], [0x000A38, 0x000A39],
  [0x000A3E, 0x000A40], [0x000A59, 0x000A5C], [0x000A66, 0x000A6F],
  [0x000A72, 0x000A74], [0x000A85, 0x000A8D], [0x000A8F, 0x000A91],
  [0x000A93, 0x000AA8], [0x000AAA, 0x000AB0], [0x000AB2, 0x000AB3],
  [0x000AB5, 0x000AB9], [0x000ABD, 0x000AC0], [0x000ACB, 0x000ACC],
  [0x000AE0, 0x000AE1], [0x000AE6, 0x000AF1], [0x000B02, 0x000B03],
  [0x000B05, 0x000B0C], [0x000B0F, 0x000B10], [0x000B13, 0x000B28],
  [0x000B2A, 0x000B30], [0x000B32, 0x000B33], [0x000B35, 0x000B39],
  [0x000B3D, 0x000B3E], [0x000B47, 0x000B48], [0x000B4B, 0x000B4C],
  [0x000B5C, 0x000B5D], [0x000B5F, 0x000B61], [0x000B66, 0x000B77],
  [0x000B85, 0x000B8A], [0x000B8E, 0x000B90], [0x000B92, 0x000B95],
  [0x000B99, 0x000B9A], [0x000B9E, 0x000B9F], [0x000BA3, 0x000BA4],
  [0x000BA8, 0x000BAA], [0x000BAE, 0x000BB9], [0x000BBE, 0x000BBF],
  [0x000BC1, 0x000BC2], [0x000BC6, 0x000BC8], [0x000BCA, 0x000BCC],
  [0x000BE6, 0x000BFA], [0x000C01, 0x000C03], [0x000C05, 0x000C0C],
  [0x000C0E, 0x000C10], [0x000C12, 0x000C28], [0x000C2A, 0x000C39],
  [0x000C41, 0x000C44], [0x000C58, 0x000C5A], [0x000C60, 0x000C61],
  [0x000C66, 0x000C6F], [0x000C77, 0x000C80], [0x000C82, 0x000C8C],
  [0x000C8E, 0x000C90], [0x000C92, 0x000CA8], [0x000CAA, 0x000CB3],
  [0x000CB5, 0x000CB9], [0x000CBD, 0x000CBE], [0x000CC0, 0x000CC4],
  [0x000CC7, 0x000CC8], [0x000CCA, 0x000CCB], [0x000CD5, 0x000CD6],
  [0x000CDD, 0x000CDE], [0x000CE0, 0x000CE1], [0x000CE6, 0x000CEF],
  [0x000CF1, 0x000CF3], [0x000D02, 0x000D0C], [0x000D0E, 0x000D10],
  [0x000D12, 0x000D3A], [0x000D3D, 0x000D40], [0x000D46, 0x000D48],
  [0x000D4A, 0x000D4C], [0x000D4E, 0x000D4F], [0x000D54, 0x000D61],
  [0x000D66, 0x000D7F], [0x000D82, 0x000D83], [0x000D85, 0x000D96],
  [0x000D9A, 0x000DB1], [0x000DB3, 0x000DBB], [0x000DC0, 0x000DC6],
  [0x000DCF, 0x000DD1], [0x000DD8, 0x000DDF], [0x000DE6, 0x000DEF],
  [0x000DF2, 0x000DF4], [0x000E01, 0x000E30], [0x000E32, 0x000E33],
  [0x000E3F, 0x000E46], [0x000E4F, 0x000E5B], [0x000E81, 0x000E82],
  [0x000E86, 0x000E8A], [0x000E8C, 0x000EA3], [0x000EA7, 0x000EB0],
  [0x000EB2, 0x000EB3], [0x000EC0, 0x000EC4], [0x000ED0, 0x000ED9],
  [0x000EDC, 0x000EDF], [0x000F00, 0x000F17], [0x000F1A, 0x000F34],
  [0x000F3A, 0x000F47], [0x000F49, 0x000F6C], [0x000F88, 0x000F8C],
  [0x000FBE, 0x000FC5], [0x000FC7, 0x000FCC], [0x000FCE, 0x000FDA],
  [0x001000, 0x00102C], [0x00103B, 0x00103C], [0x00103F, 0x001057],
  [0x00105A, 0x00105D], [0x001061, 0x001070], [0x001075, 0x001081],
  [0x001083, 0x001084], [0x001087, 0x00108C], [0x00108E, 0x00109C],
  [0x00109E, 0x0010C5], [0x0010D0, 0x0010FF], [0x001200, 0x001248],
  [0x00124A, 0x00124D], [0x001250, 0x001256], [0x00125A, 0x00125D],
  [0x001260, 0x001288], [0x00128A, 0x00128D], [0x001290, 0x0012B0],
  [0x0012B2, 0x0012B5], [0x0012B8, 0x0012BE], [0x0012C2, 0x0012C5],
  [0x0012C8, 0x0012D6], [0x0012D8, 0x001310], [0x001312, 0x001315],
  [0x001318, 0x00135A], [0x001360, 0x00137C], [0x001380, 0x001399],
  [0x0013A0, 0x0013F5], [0x0013F8, 0x0013FD], [0x001400, 0x00169C],
  [0x0016A0, 0x0016F8], [0x001700, 0x001711], [0x00171F, 0x001731],
  [0x001734, 0x001736], [0x001740, 0x001751], [0x001760, 0x00176C],
  [0x00176E, 0x001770], [0x001780, 0x0017B3], [0x0017BE, 0x0017C5],
  [0x0017C7, 0x0017C8], [0x0017D4, 0x0017DC], [0x0017E0, 0x0017E9],
  [0x0017F0, 0x0017F9], [0x001800, 0x00180A], [0x001810, 0x001819],
  [0x001820, 0x001878], [0x001880, 0x001884], [0x001887, 0x0018A8],
  [0x0018B0, 0x0018F5], [0x001900, 0x00191E], [0x001923, 0x001926],
  [0x001929, 0x00192B], [0x001930, 0x001931], [0x001933, 0x001938],
  [0x001944, 0x00196D], [0x001970, 0x001974], [0x001980, 0x0019AB],
  [0x0019B0, 0x0019C9], [0x0019D0, 0x0019DA], [0x0019DE, 0x001A16],
  [0x001A19, 0x001A1A], [0x001A1E, 0x001A55], [0x001A63, 0x001A64],
  [0x001A6D, 0x001A72], [0x001A80, 0x001A89], [0x001A90, 0x001A99],
  [0x001AA0, 0x001AAD], [0x001B04, 0x001B33], [0x001B3D, 0x001B41],
  [0x001B43, 0x001B4C], [0x001B4E, 0x001B6A], [0x001B74, 0x001B7F],
  [0x001B82, 0x001BA1], [0x001BA6, 0x001BA7], [0x001BAE, 0x001BE5],
  [0x001BEA, 0x001BEC], [0x001BF2, 0x001BF3], [0x001BFC, 0x001C2B],
  [0x001C34, 0x001C35], [0x001C3B, 0x001C49], [0x001C4D, 0x001C8A],
  [0x001C90, 0x001CBA], [0x001CBD, 0x001CC7], [0x001CE9, 0x001CEC],
  [0x001CEE, 0x001CF3], [0x001CF5, 0x001CF7], [0x001D00, 0x001DBF],
  [0x001E00, 0x001F15], [0x001F18, 0x001F1D], [0x001F20, 0x001F45],
  [0x001F48, 0x001F4D], [0x001F50, 0x001F57], [0x001F5F, 0x001F7D],
  [0x001F80, 0x001FB4], [0x001FB6, 0x001FC4], [0x001FC6, 0x001FD3],
  [0x001FD6, 0x001FDB], [0x001FDD, 0x001FEF], [0x001FF2, 0x001FF4],
  [0x001FF6, 0x001FFE], [0x002000, 0x00200A], [0x002010, 0x002027],
  [0x00202F, 0x00205F], [0x002070, 0x002071], [0x002074, 0x00208E],
  [0x002090, 0x00209C], [0x0020A0, 0x0020C0], [0x002100, 0x00218B],
  [0x002190, 0x002319], [0x00231C, 0x002328], [0x00232B, 0x0023E8],
  [0x0023ED, 0x0023EF], [0x0023F1, 0x0023F2], [0x0023F4, 0x002429],
  [0x002440, 0x00244A], [0x002460, 0x0025FC], [0x0025FF, 0x002613],
  [0x002616, 0x00262F], [0x002638, 0x002647], [0x002654, 0x00267E],
  [0x002680, 0x002689], [0x002690, 0x002692], [0x002694, 0x0026A0],
  [0x0026A2, 0x0026A9], [0x0026AC, 0x0026BC], [0x0026BF, 0x0026C3],
  [0x0026C6, 0x0026CD], [0x0026CF, 0x0026D3], [0x0026D5, 0x0026E9],
  [0x0026EB, 0x0026F1], [0x0026F6, 0x0026F9], [0x0026FB, 0x0026FC],
  [0x0026FE, 0x002704], [0x002706, 0x002709], [0x00270C, 0x002727],
  [0x002729, 0x00274B], [0x00274F, 0x002752], [0x002758, 0x002794],
  [0x002798, 0x0027AF], [0x0027B1, 0x0027BE], [0x0027C0, 0x002B1A],
  [0x002B1D, 0x002B4F], [0x002B51, 0x002B54], [0x002B56, 0x002B73],
  [0x002B76, 0x002B95], [0x002B97, 0x002CEE], [0x002CF2, 0x002CF3],
  [0x002CF9, 0x002D25], [0x002D30, 0x002D67], [0x002D6F, 0x002D70],
  [0x002D80, 0x002D96], [0x002DA0, 0x002DA6], [0x002DA8, 0x002DAE],
  [0x002DB0, 0x002DB6], [0x002DB8, 0x002DBE], [0x002DC0, 0x002DC6],
  [0x002DC8, 0x002DCE], [0x002DD0, 0x002DD6], [0x002DD8, 0x002DDE],
  [0x002E00, 0x002E5D], [0x00A4D0, 0x00A62B], [0x00A640, 0x00A66E],
  [0x00A67E, 0x00A69D], [0x00A6A0, 0x00A6EF], [0x00A6F2, 0x00A6F7],
  [0x00A700, 0x00A7CD], [0x00A7D0, 0x00A7D1], [0x00A7D5, 0x00A7DC],
  [0x00A7F2, 0x00A801], [0x00A803, 0x00A805], [0x00A807, 0x00A80A],
  [0x00A80C, 0x00A824], [0x00A827, 0x00A82B], [0x00A830, 0x00A839],
  [0x00A840, 0x00A877], [0x00A880, 0x00A8C3], [0x00A8CE, 0x00A8D9],
  [0x00A8F2, 0x00A8FE], [0x00A900, 0x00A925], [0x00A92E, 0x00A946],
  [0x00A952, 0x00A953], [0x00A983, 0x00A9B2], [0x00A9B4, 0x00A9B5],
  [0x00A9BA, 0x00A9BB], [0x00A9BE, 0x00A9CD], [0x00A9CF, 0x00A9D9],
  [0x00A9DE, 0x00A9E4], [0x00A9E6, 0x00A9FE], [0x00AA00, 0x00AA28],
  [0x00AA2F, 0x00AA30], [0x00AA33, 0x00AA34], [0x00AA40, 0x00AA42],
  [0x00AA44, 0x00AA4B], [0x00AA50, 0x00AA59], [0x00AA5C, 0x00AA7B],
  [0x00AA7D, 0x00AAAF], [0x00AAB5, 0x00AAB6], [0x00AAB9, 0x00AABD],
  [0x00AADB, 0x00AAEB], [0x00AAEE, 0x00AAF5], [0x00AB01, 0x00AB06],
  [0x00AB09, 0x00AB0E], [0x00AB11, 0x00AB16], [0x00AB20, 0x00AB26],
  [0x00AB28, 0x00AB2E], [0x00AB30, 0x00AB6B], [0x00AB70, 0x00ABE4],
  [0x00ABE6, 0x00ABE7], [0x00ABE9, 0x00ABEC], [0x00ABF0, 0x00ABF9],
  [0x00E000, 0x00F8FF], [0x00FB00, 0x00FB06], [0x00FB13, 0x00FB17],
  [0x00FB1F, 0x00FB36], [0x00FB38, 0x00FB3C], [0x00FB40, 0x00FB41],
  [0x00FB43, 0x00FB44], [0x00FB46, 0x00FBC2], [0x00FBD3, 0x00FD8F],
  [0x00FD92, 0x00FDC7], [0x00FDF0, 0x00FDFF], [0x00FE70, 0x00FE74],
  [0x00FE76, 0x00FEFC], [0x00FF61, 0x00FF9F], [0x00FFA1, 0x00FFBE],
  [0x00FFC2, 0x00FFC7], [0x00FFCA, 0x00FFCF], [0x00FFD2, 0x00FFD7],
  [0x00FFDA, 0x00FFDC], [0x00FFE8, 0x00FFEE], [0x00FFF9, 0x00FFFD],
  [0x010000, 0x01000B], [0x01000D, 0x010026], [0x010028, 0x01003A],
  [0x01003C, 0x01003D], [0x01003F, 0x01004D], [0x010050, 0x01005D],
  [0x010080, 0x0100FA], [0x010100, 0x010102], [0x010107, 0x010133],
  [0x010137, 0x01018E], [0x010190, 0x01019C], [0x0101D0, 0x0101FC],
  [0x010280, 0x01029C], [0x0102A0, 0x0102D0], [0x0102E1, 0x0102FB],
  [0x010300, 0x010323], [0x01032D, 0x01034A], [0x010350, 0x010375],
  [0x010380, 0x01039D], [0x01039F, 0x0103C3], [0x0103C8, 0x0103D5],
  [0x010400, 0x01049D], [0x0104A0, 0x0104A9], [0x0104B0, 0x0104D3],
  [0x0104D8, 0x0104FB], [0x010500, 0x010527], [0x010530, 0x010563],
  [0x01056F, 0x01057A], [0x01057C, 0x01058A], [0x01058C, 0x010592],
  [0x010594, 0x010595], [0x010597, 0x0105A1], [0x0105A3, 0x0105B1],
  [0x0105B3, 0x0105B9], [0x0105BB, 0x0105BC], [0x0105C0, 0x0105F3],
  [0x010600, 0x010736], [0x010740, 0x010755], [0x010760, 0x010767],
  [0x010780, 0x010785], [0x010787, 0x0107B0], [0x0107B2, 0x0107BA],
  [0x010800, 0x010805], [0x01080A, 0x010835], [0x010837, 0x010838],
  [0x01083F, 0x010855], [0x010857, 0x01089E], [0x0108A7, 0x0108AF],
  [0x0108E0, 0x0108F2], [0x0108F4, 0x0108F5], [0x0108FB, 0x01091B],
  [0x01091F, 0x010939], [0x010980, 0x0109B7], [0x0109BC, 0x0109CF],
  [0x0109D2, 0x010A00], [0x010A10, 0x010A13], [0x010A15, 0x010A17],
  [0x010A19, 0x010A35], [0x010A40, 0x010A48], [0x010A50, 0x010A58],
  [0x010A60, 0x010A9F], [0x010AC0, 0x010AE4], [0x010AEB, 0x010AF6],
  [0x010B00, 0x010B35], [0x010B39, 0x010B55], [0x010B58, 0x010B72],
  [0x010B78, 0x010B91], [0x010B99, 0x010B9C], [0x010BA9, 0x010BAF],
  [0x010C00, 0x010C48], [0x010C80, 0x010CB2], [0x010CC0, 0x010CF2],
  [0x010CFA, 0x010D23], [0x010D30, 0x010D39], [0x010D40, 0x010D65],
  [0x010D6E, 0x010D85], [0x010D8E, 0x010D8F], [0x010E60, 0x010E7E],
  [0x010E80, 0x010EA9], [0x010EB0, 0x010EB1], [0x010EC2, 0x010EC4],
  [0x010F00, 0x010F27], [0x010F30, 0x010F45], [0x010F51, 0x010F59],
  [0x010F70, 0x010F81], [0x010F86, 0x010F89], [0x010FB0, 0x010FCB],
  [0x010FE0, 0x010FF6], [0x011002, 0x011037], [0x011047, 0x01104D],
  [0x011052, 0x01106F], [0x011071, 0x011072], [0x011082, 0x0110B2],
  [0x0110B7, 0x0110B8], [0x0110BB, 0x0110C1], [0x0110D0, 0x0110E8],
  [0x0110F0, 0x0110F9], [0x011103, 0x011126], [0x011136, 0x011147],
  [0x011150, 0x011172], [0x011174, 0x011176], [0x011182, 0x0111B5],
  [0x0111BF, 0x0111C8], [0x0111CD, 0x0111CE], [0x0111D0, 0x0111DF],
  [0x0111E1, 0x0111F4], [0x011200, 0x011211], [0x011213, 0x01122E],
  [0x011232, 0x011233], [0x011238, 0x01123D], [0x01123F, 0x011240],
  [0x011280, 0x011286], [0x01128A, 0x01128D], [0x01128F, 0x01129D],
  [0x01129F, 0x0112A9], [0x0112B0, 0x0112DE], [0x0112E0, 0x0112E2],
  [0x0112F0, 0x0112F9], [0x011302, 0x011303], [0x011305, 0x01130C],
  [0x01130F, 0x011310], [0x011313, 0x011328], [0x01132A, 0x011330],
  [0x011332, 0x011333], [0x011335, 0x011339], [0x01133D, 0x01133F],
  [0x011341, 0x011344], [0x011347, 0x011348], [0x01134B, 0x01134D],
  [0x01135D, 0x011363], [0x011380, 0x011389], [0x011390, 0x0113B5],
  [0x0113B7, 0x0113BA], [0x0113C7, 0x0113CA], [0x0113CC, 0x0113CD],
  [0x0113D3, 0x0113D5], [0x0113D7, 0x0113D8], [0x011400, 0x011437],
  [0x011440, 0x011441], [0x011447, 0x01145B], [0x01145F, 0x011461],
  [0x011480, 0x0114B2], [0x0114BB, 0x0114BE], [0x0114C4, 0x0114C7],
  [0x0114D0, 0x0114D9], [0x011580, 0x0115B1], [0x0115B8, 0x0115BB],
  [0x0115C1, 0x0115DB], [0x011600, 0x011632], [0x01163B, 0x01163C],
  [0x011641, 0x011644], [0x011650, 0x011659], [0x011660, 0x01166C],
  [0x011680, 0x0116AA], [0x0116AE, 0x0116AF], [0x0116B8, 0x0116B9],
  [0x0116C0, 0x0116C9], [0x0116D0, 0x0116E3], [0x011700, 0x01171A],
  [0x011720, 0x011721], [0x011730, 0x011746], [0x011800, 0x01182E],
  [0x0118A0, 0x0118F2], [0x0118FF, 0x011906], [0x01190C, 0x011913],
  [0x011915, 0x011916], [0x011918, 0x011935], [0x011937, 0x011938],
  [0x01193F, 0x011942], [0x011944, 0x011946], [0x011950, 0x011959],
  [0x0119A0, 0x0119A7], [0x0119AA, 0x0119D3], [0x0119DC, 0x0119DF],
  [0x0119E1, 0x0119E4], [0x011A0B, 0x011A32], [0x011A39, 0x011A3A],
  [0x011A3F, 0x011A46], [0x011A57, 0x011A58], [0x011A5C, 0x011A89],
  [0x011A9A, 0x011AA2], [0x011AB0, 0x011AF8], [0x011B00, 0x011B09],
  [0x011BC0, 0x011BE1], [0x011BF0, 0x011BF9], [0x011C00, 0x011C08],
  [0x011C0A, 0x011C2F], [0x011C40, 0x011C45], [0x011C50, 0x011C6C],
  [0x011C70, 0x011C8F], [0x011D00, 0x011D06], [0x011D08, 0x011D09],
  [0x011D0B, 0x011D30], [0x011D50, 0x011D59], [0x011D60, 0x011D65],
  [0x011D67, 0x011D68], [0x011D6A, 0x011D8E], [0x011D93, 0x011D94],
  [0x011DA0, 0x011DA9], [0x011EE0, 0x011EF2], [0x011EF5, 0x011EF8],
  [0x011F02, 0x011F10], [0x011F12, 0x011F35], [0x011F3E, 0x011F3F],
  [0x011F43, 0x011F59], [0x011FC0, 0x011FF1], [0x011FFF, 0x012399],
  [0x012400, 0x01246E], [0x012470, 0x012474], [0x012480, 0x012543],
  [0x012F90, 0x012FF2], [0x013000, 0x01343F], [0x013441, 0x013446],
  [0x013460, 0x0143FA], [0x014400, 0x014646], [0x016100, 0x01611D],
  [0x01612A, 0x01612C], [0x016130, 0x016139], [0x016800, 0x016A38],
  [0x016A40, 0x016A5E], [0x016A60, 0x016A69], [0x016A6E, 0x016ABE],
  [0x016AC0, 0x016AC9], [0x016AD0, 0x016AED], [0x016B00, 0x016B2F],
  [0x016B37, 0x016B45], [0x016B50, 0x016B59], [0x016B5B, 0x016B61],
  [0x016B63, 0x016B77], [0x016B7D, 0x016B8F], [0x016D40, 0x016D79],
  [0x016E40, 0x016E9A], [0x016F00, 0x016F4A], [0x016F50, 0x016F87],
  [0x016F93, 0x016F9F], [0x01BC00, 0x01BC6A], [0x01BC70, 0x01BC7C],
  [0x01BC80, 0x01BC88], [0x01BC90, 0x01BC99], [0x01CC00, 0x01CCF9],
  [0x01CD00, 0x01CEB3], [0x01CF50, 0x01CFC3], [0x01D000, 0x01D0F5],
  [0x01D100, 0x01D126], [0x01D129, 0x01D166], [0x01D16A, 0x01D172],
  [0x01D183, 0x01D184], [0x01D18C, 0x01D1A9], [0x01D1AE, 0x01D1EA],
  [0x01D200, 0x01D241], [0x01D2C0, 0x01D2D3], [0x01D2E0, 0x01D2F3],
  [0x01D377, 0x01D378], [0x01D400, 0x01D454], [0x01D456, 0x01D49C],
  [0x01D49E, 0x01D49F], [0x01D4A5, 0x01D4A6], [0x01D4A9, 0x01D4AC],
  [0x01D4AE, 0x01D4B9], [0x01D4BD, 0x01D4C3], [0x01D4C5, 0x01D505],
  [0x01D507, 0x01D50A], [0x01D50D, 0x01D514], [0x01D516, 0x01D51C],
  [0x01D51E, 0x01D539], [0x01D53B, 0x01D53E], [0x01D540, 0x01D544],
  [0x01D54A, 0x01D550], [0x01D552, 0x01D6A5], [0x01D6A8, 0x01D7CB],
  [0x01D7CE, 0x01D9FF], [0x01DA37, 0x01DA3A], [0x01DA6D, 0x01DA74],
  [0x01DA76, 0x01DA83], [0x01DA85, 0x01DA8B], [0x01DF00, 0x01DF1E],
  [0x01DF25, 0x01DF2A], [0x01E030, 0x01E06D], [0x01E100, 0x01E12C],
  [0x01E137, 0x01E13D], [0x01E140, 0x01E149], [0x01E14E, 0x01E14F],
  [0x01E290, 0x01E2AD], [0x01E2C0, 0x01E2EB], [0x01E2F0, 0x01E2F9],
  [0x01E4D0, 0x01E4EB], [0x01E4F0, 0x01E4F9], [0x01E5D0, 0x01E5ED],
  [0x01E5F0, 0x01E5FA], [0x01E7E0, 0x01E7E6], [0x01E7E8, 0x01E7EB],
  [0x01E7ED, 0x01E7EE], [0x01E7F0, 0x01E7FE], [0x01E800, 0x01E8C4],
  [0x01E8C7, 0x01E8CF], [0x01E900, 0x01E943], [0x01E950, 0x01E959],
  [0x01E95E, 0x01E95F], [0x01EC71, 0x01ECB4], [0x01ED01, 0x01ED3D],
  [0x01EE00, 0x01EE03], [0x01EE05, 0x01EE1F], [0x01EE21, 0x01EE22],
  [0x01EE29, 0x01EE32], [0x01EE34, 0x01EE37], [0x01EE4D, 0x01EE4F],
  [0x01EE51, 0x01EE52], [0x01EE61, 0x01EE62], [0x01EE67, 0x01EE6A],
  [0x01EE6C, 0x01EE72], [0x01EE74, 0x01EE77], [0x01EE79, 0x01EE7C],
  [0x01EE80, 0x01EE89], [0x01EE8B, 0x01EE9B], [0x01EEA1, 0x01EEA3],
  [0x01EEA5, 0x01EEA9], [0x01EEAB, 0x01EEBB], [0x01EEF0, 0x01EEF1],
  [0x01F000, 0x01F003], [0x01F005, 0x01F02B], [0x01F030, 0x01F093],
  [0x01F0A0, 0x01F0AE], [0x01F0B1, 0x01F0BF], [0x01F0C1, 0x01F0CE],
  [0x01F0D1, 0x01F0F5], [0x01F100, 0x01F18D], [0x01F18F, 0x01F190],
  [0x01F19B, 0x01F1AD], [0x01F1E6, 0x01F1FF], [0x01F321, 0x01F32C],
  [0x01F394, 0x01F39F], [0x01F3CB, 0x01F3CE], [0x01F3D4, 0x01F3DF],
  [0x01F3F1, 0x01F3F3], [0x01F3F5, 0x01F3F7], [0x01F4FD, 0x01F4FE],
  [0x01F53E, 0x01F54A], [0x01F568, 0x01F579], [0x01F57B, 0x01F594],
  [0x01F597, 0x01F5A3], [0x01F5A5, 0x01F5FA], [0x01F650, 0x01F67F],
  [0x01F6C6, 0x01F6CB], [0x01F6CD, 0x01F6CF], [0x01F6D3, 0x01F6D4],
  [0x01F6E0, 0x01F6EA], [0x01F6F0, 0x01F6F3], [0x01F700, 0x01F776],
  [0x01F77B, 0x01F7D9], [0x01F800, 0x01F80B], [0x01F810, 0x01F847],
  [0x01F850, 0x01F859], [0x01F860, 0x01F887], [0x01F890, 0x01F8AD],
  [0x01F8B0, 0x01F8BB], [0x01F8C0, 0x01F8C1], [0x01F900, 0x01F90B],
  [0x01FA00, 0x01FA53], [0x01FA60, 0x01FA6D], [0x01FB00, 0x01FB92],
  [0x01FB94, 0x01FBF9], [0x0F0000, 0x0FFFFD], [0x100000, 0x10FFFD]
];

const range2 = [
  [0x001100, 0x00115F], [0x00231A, 0x00231B], [0x002329, 0x00232A],
  [0x0023E9, 0x0023EC], [0x0025FD, 0x0025FE], [0x002614, 0x002615],
  [0x002630, 0x002637], [0x002648, 0x002653], [0x00268A, 0x00268F],
  [0x0026AA, 0x0026AB], [0x0026BD, 0x0026BE], [0x0026C4, 0x0026C5],
  [0x0026F2, 0x0026F3], [0x00270A, 0x00270B], [0x002753, 0x002755],
  [0x002795, 0x002797], [0x002B1B, 0x002B1C], [0x002E80, 0x002E99],
  [0x002E9B, 0x002EF3], [0x002F00, 0x002FD5], [0x002FF0, 0x003029],
  [0x00302E, 0x00303E], [0x003041, 0x003096], [0x00309B, 0x0030FF],
  [0x003105, 0x00312F], [0x003131, 0x003163], [0x003165, 0x00318E],
  [0x003190, 0x0031E5], [0x0031EF, 0x00321E], [0x003220, 0x00A48C],
  [0x00A490, 0x00A4C6], [0x00A960, 0x00A97C], [0x00AC00, 0x00D7A3],
  [0x00F900, 0x00FA6D], [0x00FA70, 0x00FAD9], [0x00FE10, 0x00FE19],
  [0x00FE30, 0x00FE52], [0x00FE54, 0x00FE66], [0x00FE68, 0x00FE6B],
  [0x00FF01, 0x00FF60], [0x00FFE0, 0x00FFE6], [0x016FE0, 0x016FE3],
  [0x016FF0, 0x016FF1], [0x017000, 0x0187F7], [0x018800, 0x018CD5],
  [0x018CFF, 0x018D08], [0x01AFF0, 0x01AFF3], [0x01AFF5, 0x01AFFB],
  [0x01AFFD, 0x01AFFE], [0x01B000, 0x01B122], [0x01B150, 0x01B152],
  [0x01B164, 0x01B167], [0x01B170, 0x01B2FB], [0x01D300, 0x01D356],
  [0x01D360, 0x01D376], [0x01F191, 0x01F19A], [0x01F200, 0x01F202],
  [0x01F210, 0x01F23B], [0x01F240, 0x01F248], [0x01F250, 0x01F251],
  [0x01F260, 0x01F265], [0x01F300, 0x01F320], [0x01F32D, 0x01F335],
  [0x01F337, 0x01F37C], [0x01F37E, 0x01F393], [0x01F3A0, 0x01F3CA],
  [0x01F3CF, 0x01F3D3], [0x01F3E0, 0x01F3F0], [0x01F3F8, 0x01F43E],
  [0x01F442, 0x01F4FC], [0x01F4FF, 0x01F53D], [0x01F54B, 0x01F54E],
  [0x01F550, 0x01F567], [0x01F595, 0x01F596], [0x01F5FB, 0x01F64F],
  [0x01F680, 0x01F6C5], [0x01F6D0, 0x01F6D2], [0x01F6D5, 0x01F6D7],
  [0x01F6DC, 0x01F6DF], [0x01F6EB, 0x01F6EC], [0x01F6F4, 0x01F6FC],
  [0x01F7E0, 0x01F7EB], [0x01F90C, 0x01F93A], [0x01F93C, 0x01F945],
  [0x01F947, 0x01F9FF], [0x01FA70, 0x01FA7C], [0x01FA80, 0x01FA89],
  [0x01FA8F, 0x01FAC6], [0x01FACE, 0x01FADC], [0x01FADF, 0x01FAE9],
  [0x01FAF0, 0x01FAF8], [0x020000, 0x02A6DF], [0x02A700, 0x02B739],
  [0x02B740, 0x02B81D], [0x02B820, 0x02CEA1], [0x02CEB0, 0x02EBE0],
  [0x02EBF0, 0x02EE5D], [0x02F800, 0x02FA1D], [0x030000, 0x03134A],
  [0x031350, 0x0323AF]
];

for (const cp of cp0) widths[cp] = 0;
for (const cp of cp1) widths[cp] = 1;
for (const cp of cp2) widths[cp] = 2;

for (const [start, end] of range0)
  for (let cp = start; cp <= end; cp++) widths[cp] = 0;

for (const [start, end] of range1)
  for (let cp = start; cp <= end; cp++) widths[cp] = 1;

for (const [start, end] of range2)
  for (let cp = start; cp <= end; cp++) widths[cp] = 2;

// ---------- Build lookup table ----------
const SHIFT2 = 5;
const SHIFT1 = 11;
const MASK3 = (1 << SHIFT2) - 1;
const MASK2 = (1 << (SHIFT1 - SHIFT2)) - 1;
const TOP_BOUND = (0x10FFFF >> SHIFT1) + 1;

const L2Blocks: Uint32Array[] = [];
const leafBlocks: Uint8Array[] = [];

for (let i1 = 0; i1 < TOP_BOUND; i1++) {
  const L2tab = new Uint32Array(MASK2 + 1);

  for (let i2 = 0; i2 < L2tab.length; i2++) {
    const baseCp = (i1 << SHIFT1) | (i2 << SHIFT2);
    const leaf = new Uint8Array(MASK3 + 1);

    for (let i3 = 0; i3 <= MASK3; i3++) {
      const cp = baseCp + i3;
      leaf[i3] = cp <= 0x10FFFF ? widths[cp] : 0xFF;
    }

    if (baseCp <= 0x10FFFF) {
      leafBlocks.push(leaf);
      L2tab[i2] = leafBlocks.length; // temporary index
    }
  }

  L2Blocks.push(L2tab);
}

const HEADER_BYTES = 5 * 4;
const L1_BYTES = TOP_BOUND * 4;
const L2_TOTAL = L2Blocks.reduce((sum, tab) => sum + tab.length * 4, 0);
const LEAF_TOTAL = leafBlocks.length * (MASK3 + 1);
const TOTAL_BYTES = HEADER_BYTES + L1_BYTES + L2_TOTAL + LEAF_TOTAL;

const LOOKUP_TABLE = new Uint8Array(TOTAL_BYTES);
const view = new DataView(LOOKUP_TABLE.buffer);

// Header
view.setUint32(0, SHIFT1, true);
view.setUint32(4, TOP_BOUND, true);
view.setUint32(8, SHIFT2, true);
view.setUint32(12, MASK2, true);
view.setUint32(16, MASK3, true);

// Offsets
let L2ptr = HEADER_BYTES + L1_BYTES;
let LEAFptr = L2ptr + L2_TOTAL;

for (let i1 = 0; i1 < TOP_BOUND; i1++) {
  const L2tab = L2Blocks[i1];
  view.setUint32(20 + i1 * 4, L2ptr, true);

  for (let i2 = 0; i2 < L2tab.length; i2++) {
    const leafIndex = L2tab[i2];
    if (leafIndex) {
      view.setUint32(L2ptr + i2 * 4, LEAFptr, true);
      LOOKUP_TABLE.set(leafBlocks[leafIndex - 1], LEAFptr);
      LEAFptr += MASK3 + 1;
    } else {
      view.setUint32(L2ptr + i2 * 4, 0, true);
    }
  }

  L2ptr += L2tab.length * 4;
}

/**
 * Wcwidth lookup table.
 */
export const TABLE: Uint8Array = LOOKUP_TABLE;
